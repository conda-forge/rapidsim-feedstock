From cdee9b4186e4703f55c4fb6a4edc8fb18aaab804 Mon Sep 17 00:00:00 2001
From: Daniel Craik <daniel.charles.craik@cern.ch>
Date: Sat, 14 Dec 2019 16:48:37 -0500
Subject: [PATCH 5/6] Use EvtMTRandomEngine with same seed as used for gRandom

---
 src/RapidConfig.cc         | 3 ++-
 src/RapidExternalEvtGen.cc | 5 +++--
 2 files changed, 5 insertions(+), 3 deletions(-)

diff --git a/src/RapidConfig.cc b/src/RapidConfig.cc
index 35197de..ca2638c 100644
--- a/src/RapidConfig.cc
+++ b/src/RapidConfig.cc
@@ -295,6 +295,8 @@ bool RapidConfig::loadDecay() {
 bool RapidConfig::loadConfig() {
 	std::cout << "INFO in RapidConfig::loadConfig : attempting to load configuration from file: " << fileName_+".config" << std::endl;
 
+	gRandom->SetSeed(0.);
+
 	std::ifstream fin;
 	fin.open(fileName_+".config", std::ifstream::in);
 	if( ! fin.good()) {
@@ -441,7 +443,6 @@ bool RapidConfig::configParticle(unsigned int part, TString command, TString val
 }
 
 bool RapidConfig::configGlobal(TString command, TString value) {
-	gRandom->SetSeed(0.);
 	if(command=="seed") {
 		int seed = value.Atoi();
 		gRandom->SetSeed(seed);
diff --git a/src/RapidExternalEvtGen.cc b/src/RapidExternalEvtGen.cc
index daef710..8d8385e 100644
--- a/src/RapidExternalEvtGen.cc
+++ b/src/RapidExternalEvtGen.cc
@@ -4,6 +4,7 @@
 #include <fstream>
 #include <queue>
 
+#include "TRandom.h"
 #include "TSystem.h"
 
 #ifdef RAPID_EVTGEN
@@ -15,7 +16,6 @@
 #include "EvtGenBase/EvtParticleFactory.hh"
 #include "EvtGenBase/EvtPatches.hh"
 #include "EvtGenBase/EvtPDL.hh"
-#include "EvtGenBase/EvtSimpleRandomEngine.hh"
 #include "EvtGenBase/EvtMTRandomEngine.hh"
 
 #include "EvtGenExternal/EvtExternalGenList.hh"
@@ -119,7 +119,8 @@ bool RapidExternalEvtGen::setupGenerator() {
 	std::list<EvtDecayBase*> extraModels;
 
 	// Define the random number generator
-	randomEngine = new EvtSimpleRandomEngine();
+	uint seed = gRandom->GetSeed();
+	randomEngine = new EvtMTRandomEngine(seed);
 
 	bool useEvtGenRandom(false);
 	EvtExternalGenList genList(true, "", "gamma", useEvtGenRandom);
-- 
2.48.1

